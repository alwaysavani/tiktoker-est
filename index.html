<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Token & Cost Estimator</title>
    <!-- Tailwind CSS CDN for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for a clean, modern look */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* Dark background */
            color: #e2e8f0; /* Light text */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
        }
        .container {
            max-width: 800px;
            width: 100%;
        }
        .card {
            background-color: #2d3748; /* Darker card background */
            padding: 2.5rem;
            border-radius: 1.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            border: 1px solid #4a5568;
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="card">
            <h1 class="text-3xl font-bold text-center mb-4">AI Token & Cost Estimator</h1>
            <p class="text-center text-gray-400 mb-8">
                Estimate tokens, financial cost, and electricity consumption.
            </p>

            <div class="mb-6">
                <label for="text-input" class="block text-sm font-medium text-gray-300 mb-2">Enter your text:</label>
                <textarea id="text-input" rows="10" class="w-full p-4 rounded-lg bg-gray-700 text-gray-200 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200" placeholder="Paste your text here..."></textarea>
            </div>

            <!-- New input fields for token price and electricity cost -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <div>
                    <label for="price-input" class="block text-sm font-medium text-gray-300 mb-2">Price per 1 Million Tokens (USD):</label>
                    <input type="number" id="price-input" value="10" min="0.01" step="0.01" class="w-full p-3 rounded-lg bg-gray-700 text-gray-200 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label for="electricity-input" class="block text-sm font-medium text-gray-300 mb-2">Cost per kWh (USD):</label>
                    <input type="number" id="electricity-input" value="0.15" min="0.01" step="0.01" class="w-full p-3 rounded-lg bg-gray-700 text-gray-200 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
            </div>

            <div class="flex flex-col sm:flex-row justify-center items-center space-y-4 sm:space-y-0 sm:space-x-4 mb-8">
                <button id="estimate-button" class="w-full sm:w-auto px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    Estimate
                </button>
                <button id="clear-button" class="w-full sm:w-auto px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-gray-500">
                    Clear
                </button>
            </div>

            <div id="result-area" class="text-center p-6 bg-gray-800 rounded-lg border border-gray-700 transition-all duration-300 transform scale-0 opacity-0">
                <p class="text-sm text-gray-400 mb-4">Your text has approximately:</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div>
                        <p id="token-count" class="text-3xl font-extrabold text-blue-400">0</p>
                        <p class="text-sm text-gray-400">Tokens</p>
                    </div>
                    <div>
                        <p id="cost-estimate" class="text-3xl font-extrabold text-green-400">$0.00</p>
                        <p class="text-sm text-gray-400">Cost</p>
                    </div>
                    <div>
                        <p id="electricity-estimate" class="text-3xl font-extrabold text-red-400">0.00</p>
                        <p class="text-sm text-gray-400">kWh</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Get references to DOM elements
        const textInput = document.getElementById('text-input');
        const priceInput = document.getElementById('price-input');
        const electricityInput = document.getElementById('electricity-input');
        const estimateButton = document.getElementById('estimate-button');
        const clearButton = document.getElementById('clear-button');
        const resultArea = document.getElementById('result-area');
        const tokenCountDisplay = document.getElementById('token-count');
        const costEstimateDisplay = document.getElementById('cost-estimate');
        const electricityEstimateDisplay = document.getElementById('electricity-estimate');

        // Function to animate the result area
        const showResult = () => {
            resultArea.classList.remove('scale-0', 'opacity-0');
            resultArea.classList.add('scale-100', 'opacity-100');
        };

        const hideResult = () => {
            resultArea.classList.remove('scale-100', 'opacity-100');
            resultArea.classList.add('scale-0', 'opacity-0');
        };

        // This is a simple, approximate token counting function
        // A real implementation would make an API call to a backend running `tiktoken`
        const estimateTokens = (text) => {
            // Trim leading/trailing whitespace
            const trimmedText = text.trim();
            if (trimmedText === '') {
                return 0;
            }

            // Simple approximation: word count + punctuation
            const words = trimmedText.split(/\s+/);
            const wordCount = words.length;
            const punctuationCount = (trimmedText.match(/[.,!?;:'"()\[\]{}]/g) || []).length;
            
            return Math.ceil(wordCount * 1.3 + punctuationCount);
        };

        // Event listener for the "Estimate" button
        estimateButton.addEventListener('click', () => {
            const text = textInput.value;
            const pricePerMillionTokens = parseFloat(priceInput.value);
            const electricityCostPerKWh = parseFloat(electricityInput.value);

            const tokenCount = estimateTokens(text);

            // Calculate financial cost
            const cost = (tokenCount / 1000000) * pricePerMillionTokens;

            // Calculate electricity consumption (based on a common heuristic)
            // The heuristic is that generating 1 token consumes approximately 0.0003 kWh (300 Wh per million tokens).
            // Note: This is a very rough estimate and can vary widely.
            const electricityConsumption = (tokenCount / 1000000) * 0.3; // 0.3 kWh per million tokens

            tokenCountDisplay.textContent = tokenCount.toLocaleString();
            costEstimateDisplay.textContent = `$${cost.toFixed(4)}`;
            electricityEstimateDisplay.textContent = electricityConsumption.toFixed(4);

            showResult();
        });

        // Event listener for the "Clear" button
        clearButton.addEventListener('click', () => {
            textInput.value = '';
            tokenCountDisplay.textContent = '0';
            costEstimateDisplay.textContent = '$0.00';
            electricityEstimateDisplay.textContent = '0.00';
            hideResult();
        });

        // Hide result area initially
        hideResult();
    </script>

</body>
</html>
